<!DOCTYPE html>
<html><head><title>Blockchain Demo</title>
<meta charset="UTF-8">
<link rel=stylesheet href="../css/blockchain.css" type="text/css">
<style type="text/css">
.main
{
  width: 90%;
}

</style>
</head>
<body>

  <div class="generate">
    <div class="header-hash">Previous hash</div>
    <div class="header-data">Data</div>
    <div class="header-user">User</div>
    <div class="header-nonce">Nonce</div>

    <div class="broken-out-inputs-hash"><input id="previous-hash" type="text" value="" placeholder="Previous Hash" onkeyup="generate_hash()" onblur="generate_hash()" /></div>
    <div class="broken-out-inputs-data"><input id="data" type="text" value="" placeholder="Data" onkeyup="generate_hash()" onblur="generate_hash()" /></div>
    <div class="broken-out-inputs-user"><input id="user" type="text" value="" placeholder="User" onkeyup="generate_hash()" onblur="generate_hash()" /></div>
    <div class="broken-out-inputs-nonce"><span id="nonce">0</span></div>
    <div class="broken-out-inputs-increment"><button id="increment" onclick="increment(1)">Increment</button></div>
    <div class="broken-out-inputs-decrement"><button id="decrement" onclick="increment(-1)">Decrement</button></div>
    <div class="broken-out-inputs-reset"><button id="reset" onclick="reset()">Reset</button></div>

    <div class="input-text-label"><label>Input text</label></div>
    <div class="input-text-value"><span id="input-text" value=""></span></div>

    <div class="output-label"><label>Output hash</label></div>
    <div class="output-value"><span id="output">5948461a44d43e2d2c8c222ea87dcb5a7ea3549ab5a90215ead48d5e93e617ea</span></div>
    <div class="output-zero-label"><label>Zeros:</label></div>
    <div class="output-counter"><span id="counter">0</span></div>
  </div>
  <hr>
  <div class="verify">
    <div class="verify-input-text-label"><label>Input text</label></div>
    <div class="verify-input-text-value"><input id="verify-text" type="text" value="" placeholder="text" onkeyup="verify_hash()" onblur="verify_hash()" /></div>

    <div class="verify-output-label"><label>Output hash</label></div>
    <div class="verify-output-value"><span id="verify-hash">verify</span></div>
  </div>

<script src="../js/hashfunctions.js"></script>
<script type="text/javascript">
<!--
var LOWER_HEX = "0123456789abcdef";
var DELIMITER = ';'

function reset() {
  document.getElementById('nonce').textContent = '0'
  generate_hash()
}

function increment(delta) {
  nonce = parseInt(document.getElementById('nonce').textContent)
  nonce += delta
  document.getElementById('nonce').textContent = nonce
  generate_hash()
}

function generate_hash() {
  previous_hash = document.getElementById('previous-hash').value
  data = document.getElementById('data').value
  user = document.getElementById('user').value
  nonce = document.getElementById('nonce').textContent
  combined_input = previous_hash + DELIMITER + data + DELIMITER + user + DELIMITER + nonce
  document.getElementById('input-text').textContent = combined_input
  digest = any_sha256(combined_input, LOWER_HEX)
  document.getElementById('output').textContent = digest
  document.getElementById('counter').textContent = count_leading_chars(digest, '0')
}

function verify_hash() {
  input_text = document.getElementById('verify-text').value
  document.getElementById('verify-hash').textContent = any_sha256(input_text, LOWER_HEX)
}

function count_leading_chars(string, char) {
  for (var ii = 0; ii < string.length; ii++) {
    if (string[ii] != char) { break; }
  }
  return ii;
}
-->
</script>
</body>
</html>
